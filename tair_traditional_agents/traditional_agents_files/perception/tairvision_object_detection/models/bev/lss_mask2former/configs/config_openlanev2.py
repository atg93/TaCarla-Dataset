import argparse
from tairvision.models.bev.lss_mask2former.configs.config import _C, CfgNode, get_parser, get_cfg
from tairvision.models.bev.lss_mask2former.configs.optimal_transport_config import OPTIMAL_TRANSPORT_HEAD


CN = CfgNode

_C.LIFT.Y_BOUND = [-26.0, 26.0, 0.5]
_C.MODEL.HEADDYNAMIC.SEMANTIC_SEG.WEIGHTS = [1.0, 1.0, 1.0, 1.0, 1.0]

_C.VIS_INTERVAL = 5000
_C.LOGGING_INTERVAL = 500

_C.DATASET.VERSION = "data_dict_subset_A"
_C.DATASET.DATAROOT = "/datasets/OpenLane-V2"
_C.DATASET.CENTERLINE_THICKNESS = 4
_C.DATASET.PERSPECTIVE_TRANSFORM_TRAIN = "multiscale_box_normalized"
_C.DATASET.PERSPECTIVE_TRANSFORM_VAL = "standard_normalized"
_C.DATASET.BEZIER_CONTROL_POINTS = 5
_C.DATASET.ENABLE_TRAINVAL_TRAINING = False
_C.MODEL.DYNAMIC_TRANSFORMER_DECODER.MASKED_TRANSFORMER_DECODER_CONFIG.CODE_SIZE = 3 * _C.DATASET.BEZIER_CONTROL_POINTS

_C.IMAGE.HFLIP_PROB = 0.0
_C.IMAGE.VFLIP_PROB = 0.0
_C.IMAGE.ROTATE_PROB = 0.0

_C.IMAGE.BACKBONE_MEAN_2D = [0.485, 0.456, 0.406]
_C.IMAGE.BACKBONE_STD_2D = [0.229, 0.224, 0.225]


_C.IMAGE.FINAL_DIM = (320, 448)
_C.IMAGE.RESIZE_SCALE_WIDTH = 0.21875
_C.IMAGE.RESIZE_SCALE_HEIGHT = 0.21875
_C.IMAGE.TOP_CROP = 19
_C.IMAGE.ORIGINAL_HEIGHT = 1550  # Original input RGB camera height
_C.IMAGE.ORIGINAL_WIDTH = 2048  # Original input RGB camera width

_C.IMAGE.NAMES = [
    'RING_FRONT_CENTER',
    'RING_FRONT_LEFT',
    'RING_FRONT_RIGHT', 
    'RING_REAR_LEFT', 
    'RING_REAR_RIGHT',
    'RING_SIDE_LEFT',
    'RING_SIDE_RIGHT'
    ]

_C.FRONT_CENTER_IMAGE = _C.IMAGE.clone()
_C.FRONT_CENTER_IMAGE.RESIZE_SCALE_WIDTH = 0.2890
_C.FRONT_CENTER_IMAGE.RESIZE_SCALE_HEIGHT = 0.25
_C.FRONT_CENTER_IMAGE.TOP_CROP = 192
_C.FRONT_CENTER_IMAGE.ORIGINAL_HEIGHT = 2048  # Original input RGB camera height
_C.FRONT_CENTER_IMAGE.ORIGINAL_WIDTH = 1550  # Original input RGB camera width


_C.MODEL.USE_OPTIMAL_TRANSPORT_HEAD = False
_C.MODEL.OPTIMAL_TRANSPORT_HEAD = OPTIMAL_TRANSPORT_HEAD