from tairvision.models.bev.lss.training.config import CfgNode

CN = CfgNode
OPTIMAL_TRANSPORT_HEAD = CN()
OPTIMAL_TRANSPORT_HEAD.SINKHORN_ACTIVATED = False
OPTIMAL_TRANSPORT_HEAD.SINKHORN_ACTIVATED_LCTE = False
OPTIMAL_TRANSPORT_HEAD.LOSS_COEFFICIENT_LCLC = 100.0
OPTIMAL_TRANSPORT_HEAD.NUMBER_OF_SELECTED_QUERIES_LC = 100
OPTIMAL_TRANSPORT_HEAD.LOSS_COEFFICIENT_LCTE = 500.0
OPTIMAL_TRANSPORT_HEAD.NUMBER_OF_SELECTED_QUERIES_TE = 30
OPTIMAL_TRANSPORT_HEAD.NUMBER_OF_SINKHORN_ITERATIONS = 20
OPTIMAL_TRANSPORT_HEAD.METHODOLOGY = "similarity_based"
OPTIMAL_TRANSPORT_HEAD.METHODOLOGY_LCTE = "similarity_based"
OPTIMAL_TRANSPORT_HEAD.SHARED_PROJECTION = True
OPTIMAL_TRANSPORT_HEAD.NUMBER_OF_MLP_LAYERS = 2
OPTIMAL_TRANSPORT_HEAD.NORMALIZED_POSITIONS = False
OPTIMAL_TRANSPORT_HEAD.ENABLE_IMPROVED_RELATIONS = False
OPTIMAL_TRANSPORT_HEAD.IMPROVED_RELATIONS_NHEADS = 8
OPTIMAL_TRANSPORT_HEAD.IMPROVED_RELATIONS_NUM_LAYERS = 3
OPTIMAL_TRANSPORT_HEAD.IMPROVED_RELATIONS_ENABLE_AUX_LOSS = False
OPTIMAL_TRANSPORT_HEAD.ENABLE_CENTERLINE_PREDICTION_AFTER_RELATION = False
OPTIMAL_TRANSPORT_HEAD.REPROJECT_MASK_FEATURES_IN_FINAL_PREDICTOR = False
OPTIMAL_TRANSPORT_HEAD.ENABLE_SEPARATE_IMPROVED_RELATIONS_FOR_FINAL_CENTERLINE = False
OPTIMAL_TRANSPORT_HEAD.ENABLE_FILTERING = True